Analysis pipeline
=================

The Makefile here can be used to run the <code>gene-check</code> and filtering pipeline.

Place executable filters in <code>filters/</code>. Note that filters must not have extensions (i.e. name your filter <code>demo_filter</code>, not <code>demo_filter.py</code>.

# Description of labels
## Initial labels
These labels are applied by `gene-check`.
* **noStart** -- The CDS does not start with `ATG`.
* **noStop** -- The CDS does not end (in-frame) with a recognized stop codon, i.e. `TAA` or `TAG` or `TGA`.
* **badFrame** -- The CDS is not a multiple of three.
* **frameMismatch** -- At least one exon within the CDS is not a multiple of three.
* **noCDS** -- The transcript lacks coding sequence.
* **cdsGap** -- There exists a region between two CDS exons that is too small to be an intron
* **cdsMult3Gap** -- The region between two exons is a multiple of three.
* **utrGap** -- There exists a region between two UTR exons that is too small to be an intron
* **cdsUnknownSplice** -- The transcript contains at least one CDS splice site that is not a known site, e.g. `GT..AG`, `GC..AG`, `AT..AC`.
* **cdsNonCanonSplice** -- The transcript contains at least one CDS splice site is not the cannonical site, i.e. `GT..AG`.
* **utrUnknownSplice** -- The transcript contains at least one UTR splice site is not a known site, e.g. `GT..AG`, `GC..AG`, `AT..AC`.
* **utrNonCanonSplice** -- The transcript contains at least one UTR splice site is not the cannonical site, i.e. `GT..AG`.


## Additional labels
These labels are applied by this pipeline.
* **alignmentPartialMap** -- Applied to `noStop` and `noStart` labels if any base(s) of the transcript fail to align to the target sequence. Applied by the `shortScaffold_noStartStop` filter.
* **alignmentAbutsEdge** -- Applied to `noStop` and `noStart` labels if any part of the transcript aligns to the first or last base on the target sequence. Applied by the `shortScaffold_noStartStop` filter.
* **containsNs** -- Checks the sequence to see if any `N` characters are present anywhere within the transcript. Applied by the `nLook` filter.
* **hasOkCopy** -- There exists at least one position (not including the transcript being labeled) where this transcript aligns to the target genome and is Ok (i.e. has no labels other than `hasOkCopy`). Applied by the `paralogs` filter.
* **hasBadCopy** -- There exists at least one position (not including the transcript being labeled) where this transcript aligns to the target genome and is not Ok (i.e. has labels other than `hasOkCopy`). Applied by the `paralogs` filter.
* **_preexisting** -- A `_preexisting` suffix on any label means that the transcript contains the same label when evaluated in the originating genome. I.e. when `gene-check` is run on mm10 using the wgEncodeGencodeCompVM2 annotations this same label is applied to that transcript, indicating that the label was not created by the assembly, alignment or trans map processes. Applied by the `gigo` filter.
* **outOfFrameStop** -- Applied to `noStop` labels, checks the last three bases of the transcript (regardless of frame) and checks to see if it is a recognized stop codon, i.e. `TAA`, `TAG` or `TGA`, if they are then this label is applied.
* **+** -- A wildcard charater, `+` indicates there are other labels that follow. Generated by the `src/geneCheckStats.py` tool.
